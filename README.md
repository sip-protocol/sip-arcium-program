<div align="center">

<pre>
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘
â•šâ•â•â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â•â•     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘
â•šâ•â•â•â•â•â•â• â•šâ•â• â•šâ•â•         â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•     â•šâ•â•
</pre>

# SIP Arcium Program

> **Privacy through MPC â€” no single node sees your data**

**Confidential DeFi on Solana using Arcium's Multi-Party Computation network**

*Encrypted transfers â€¢ Confidential swaps â€¢ Balance privacy â€¢ Jupiter integration*

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Rust](https://img.shields.io/badge/Rust-1.75-orange?logo=rust&logoColor=white)](https://www.rust-lang.org/)
[![Anchor](https://img.shields.io/badge/Anchor-0.30-blueviolet)](https://www.anchor-lang.com/)
[![Arcium](https://img.shields.io/badge/Arcium-0.6.5-00D4AA)](https://arcium.com/)
[![Solana](https://img.shields.io/badge/Solana-Devnet-9945FF?logo=solana&logoColor=white)](https://solana.com/)

**Solana Privacy Hackathon 2026** | [Arcium Track Submission](https://sip-protocol.org/showcase/solana-privacy-2026)

</div>

---

## Table of Contents

- [What is SIP Arcium?](#-what-is-sip-arcium)
- [The Problem](#-the-problem)
- [The Solution](#-the-solution)
- [MPC Circuits](#-mpc-circuits)
- [Architecture](#%EF%B8%8F-architecture)
- [Deployment](#-deployment)
- [Quick Start](#-quick-start)
- [Integration](#-integration)
- [Tech Stack](#%EF%B8%8F-tech-stack)
- [Development](#-development)
- [Security](#-security)
- [Related Projects](#-related-projects)
- [License](#-license)

---

## ğŸ›¡ï¸ What is SIP Arcium?

SIP Arcium brings **confidential DeFi** to Solana using Arcium's Multi-Party Computation (MPC) network. Your balance and transfer amounts stay encrypted throughout the entire computation â€” no single node ever sees your actual values.

```
Traditional DeFi  â†’ Public balances, public amounts, MEV attacks
SIP + Arcium      â†’ Encrypted computation, hidden amounts, MEV protection
```

**Your financial data stays private. Even during computation.**

---

## ğŸ¯ The Problem

Current Solana DeFi exposes **everything** on-chain:

| Data Point | Visibility | Risk |
|------------|------------|------|
| **Token Balances** | Public | Wealth profiling, targeted attacks |
| **Transfer Amounts** | Public | Front-running, sandwich attacks |
| **Swap Details** | Public | MEV extraction, copy trading |
| **Transaction Graph** | Permanent | Surveillance, address clustering |

### Why ZK Alone Isn't Enough

Zero-knowledge proofs verify correctness, but the **computation itself** still happens somewhere. With ZK:
- Prover sees all values during proof generation
- Single point of trust (the prover)
- Complex circuits for arbitrary logic

**MPC solves this** â€” computation is distributed across multiple nodes, none of which see the plaintext.

---

## ğŸ’¡ The Solution

SIP Arcium uses **threshold MPC** to perform DeFi operations on encrypted data:

### How It Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. CLIENT (SIP Mobile / Web App)                               â”‚
â”‚     â””â”€â”€ Encrypt inputs with x25519 keypair                      â”‚
â”‚         (balance, amount, slippage â€” all encrypted)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. ANCHOR PROGRAM (this repo)                                  â”‚
â”‚     â””â”€â”€ Queue encrypted computation to Arcium MXE               â”‚
â”‚         (on-chain coordination, no plaintext access)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. ARCIUM MXE CLUSTER (off-chain MPC network)                  â”‚
â”‚     â”œâ”€â”€ Threshold decrypt (requires 2/3+ nodes)                 â”‚
â”‚     â”œâ”€â”€ Execute circuit (distributed computation)               â”‚
â”‚     â”‚   â””â”€â”€ No single node sees complete plaintext              â”‚
â”‚     â”œâ”€â”€ Encrypt result with requester's key                     â”‚
â”‚     â””â”€â”€ Return via callback                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4. CALLBACK (back on-chain)                                    â”‚
â”‚     â””â”€â”€ Emit encrypted result                                   â”‚
â”‚         (only requester can decrypt)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### MPC Guarantees

| Property | Description |
|----------|-------------|
| **Confidentiality** | No single node sees plaintext values |
| **Correctness** | Threshold signatures verify computation |
| **Availability** | Tolerates minority node failures |
| **Non-collusion** | Requires 2/3+ nodes to collude to break privacy |

---

## ğŸ” MPC Circuits

Three Arcis circuits for confidential DeFi operations:

### 1. Private Transfer (`private_transfer`)

Validate encrypted balance transfers without revealing amounts.

```rust
// Inputs (all encrypted)
struct PrivateTransferInput {
    sender_balance: u64,  // Current balance (encrypted)
    amount: u64,          // Transfer amount (encrypted)
    min_balance: u64,     // Minimum to maintain (encrypted)
}

// Outputs (encrypted with requester's key)
struct PrivateTransferOutput {
    is_valid: bool,           // Sufficient balance?
    new_sender_balance: u64,  // Balance after transfer
}
```

**Use case:** Shielded SOL/token transfers in SIP Mobile

### 2. Balance Check (`check_balance`)

Threshold check without revealing actual balance.

```rust
// Prove balance >= minimum without revealing balance
check_balance(balance: u64, minimum: u64) -> bool
```

**Use case:** Pre-validation, rent exemption checks, minimum balance requirements

### 3. Confidential Swap (`validate_swap`)

Validate DEX swaps with encrypted slippage protection.

```rust
// Inputs (all encrypted)
struct ConfidentialSwapInput {
    input_balance: u64,   // Token balance
    input_amount: u64,    // Swap input
    min_output: u64,      // Slippage protection
    actual_output: u64,   // DEX quote result
}

// Outputs
struct ConfidentialSwapOutput {
    is_valid: bool,          // Sufficient balance?
    new_input_balance: u64,  // Balance after swap
    slippage_ok: bool,       // Within tolerance?
}
```

**Use case:** Jupiter swaps with hidden amounts in SIP Mobile

---

## ğŸ—ï¸ Architecture

### Project Structure

```
sip-arcium-program/
â”œâ”€â”€ programs/
â”‚   â””â”€â”€ sip_arcium_transfer/
â”‚       â””â”€â”€ src/
â”‚           â””â”€â”€ lib.rs          # Anchor program
â”‚               â”œâ”€â”€ init_*_comp_def()     # Initialize computation definitions
â”‚               â”œâ”€â”€ private_transfer()     # Queue transfer computation
â”‚               â”œâ”€â”€ check_balance()        # Queue balance check
â”‚               â”œâ”€â”€ validate_swap()        # Queue swap validation
â”‚               â””â”€â”€ *_callback()           # Handle MXE responses
â”œâ”€â”€ encrypted-ixs/
â”‚   â””â”€â”€ src/
â”‚       â””â”€â”€ lib.rs              # Arcis MPC circuits
â”‚           â”œâ”€â”€ private_transfer()   # Transfer validation circuit
â”‚           â”œâ”€â”€ check_balance()      # Balance threshold circuit
â”‚           â””â”€â”€ validate_swap()      # Swap validation circuit
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ init-comp-defs.ts       # Deploy computation definitions
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ sip_arcium_transfer.ts  # Integration tests
â”œâ”€â”€ Anchor.toml                 # Anchor config
â”œâ”€â”€ Arcium.toml                 # Arcium MXE config
â””â”€â”€ Cargo.toml                  # Rust dependencies
```

### Data Flow

```
User Input â†’ Encrypt (x25519) â†’ Anchor Program â†’ MXE Queue
                                                      â”‚
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â–¼                       â–¼
                                    MXE Node 1              MXE Node 2
                                          â”‚                       â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â–¼
                                              Threshold MPC
                                              (compute on shares)
                                                      â”‚
                                                      â–¼
                                              Encrypt Result
                                                      â”‚
                                                      â–¼
                                              Callback â†’ Client Decrypt
```

---

## ğŸ“ Deployment

### Devnet (Current)

| Field | Value |
|-------|-------|
| **Program ID** | `S1P5q5497A6oRCUutUFb12LkNQynTNoEyRyUvotmcX9` |
| **MXE Account** | `5qy4Njk4jCJE4QgZ5dsg8uye3vzFypFTV7o7RRSQ8vr4` |
| **Cluster Offset** | 456 |
| **Arcium Version** | v0.6.3 (devnet) |

### Explorer Links

- [Program on Solscan](https://solscan.io/account/S1P5q5497A6oRCUutUFb12LkNQynTNoEyRyUvotmcX9?cluster=devnet)
- [MXE Account](https://solscan.io/account/5qy4Njk4jCJE4QgZ5dsg8uye3vzFypFTV7o7RRSQ8vr4?cluster=devnet)

---

## ğŸš€ Quick Start

### Prerequisites

- Rust 1.75+
- Solana CLI 1.18+
- Anchor 0.30+
- Node.js 20+

### Setup

```bash
# Clone the repository
git clone https://github.com/sip-protocol/sip-arcium-program.git
cd sip-arcium-program

# Install dependencies
yarn install

# Build program + circuits
anchor build

# Run tests
anchor test

# Deploy to devnet
anchor deploy --provider.cluster devnet

# Initialize computation definitions
npx ts-node scripts/init-comp-defs.ts
```

### Local Development with Arcium

```bash
# Start local validator with Arcium
arcium localnet

# Deploy locally
anchor deploy --provider.cluster localnet

# Test with local MXE
anchor test --provider.cluster localnet
```

---

## ğŸ”Œ Integration

### From SIP Mobile (TypeScript)

```typescript
import { ArciumAdapter } from '@/privacy-providers/arcium'
import { Connection, Keypair } from '@solana/web3.js'

// Initialize adapter
const adapter = new ArciumAdapter({
  programId: 'S1P5q5497A6oRCUutUFb12LkNQynTNoEyRyUvotmcX9',
  mxeAccount: '5qy4Njk4jCJE4QgZ5dsg8uye3vzFypFTV7o7RRSQ8vr4',
  connection: new Connection('https://api.devnet.solana.com'),
})

// Validate a private transfer
const result = await adapter.validateTransfer({
  senderBalance: 1000000000n,  // 1 SOL in lamports
  amount: 100000000n,          // 0.1 SOL
  minBalance: 890880n,         // Rent exemption
  encryptionKeypair,           // x25519 keypair
})

if (result.isValid) {
  // Proceed with transfer
  console.log('New balance:', result.newSenderBalance)
}
```

### From Rust (Direct)

```rust
use anchor_lang::prelude::*;
use sip_arcium_transfer::cpi::accounts::PrivateTransfer;
use sip_arcium_transfer::cpi::private_transfer;

// Queue computation
private_transfer(
    ctx.accounts.into(),
    computation_offset,
    encrypted_balance,
    encrypted_amount,
    encrypted_min_balance,
    x25519_pubkey,
    nonce,
)?;
```

---

## ğŸ› ï¸ Tech Stack

| Category | Technology | Purpose |
|----------|------------|---------|
| **Language** | Rust 1.75 | Program + circuits |
| **Framework** | Anchor 0.30 | Solana program framework |
| **MPC** | Arcium SDK 0.6.5 | Confidential computation |
| **Circuits** | Arcis | MPC circuit DSL |
| **Encryption** | x25519 | Input/output encryption |
| **Testing** | Mocha + Chai | Integration tests |
| **Deployment** | Solana CLI | On-chain deployment |

---

## ğŸ’» Development

### Commands

```bash
# Build everything
anchor build

# Run tests
anchor test

# Deploy to devnet
anchor deploy --provider.cluster devnet

# Initialize computation definitions
npx ts-node scripts/init-comp-defs.ts

# Check program logs
solana logs S1P5q5497A6oRCUutUFb12LkNQynTNoEyRyUvotmcX9
```

### Adding a New Circuit

1. Define the circuit in `encrypted-ixs/src/lib.rs`:

```rust
pub struct MyInput { /* encrypted fields */ }
pub struct MyOutput { /* result fields */ }

#[instruction]
pub fn my_circuit(input: Enc<Shared, MyInput>) -> Enc<Shared, MyOutput> {
    // MPC computation logic
}
```

2. Add Anchor instructions in `programs/sip_arcium_transfer/src/lib.rs`:

```rust
pub fn my_circuit(ctx: Context<MyCircuit>, /* params */) -> Result<()> {
    queue_computation(/* ... */)?;
    Ok(())
}

#[arcium_callback(encrypted_ix = "my_circuit")]
pub fn my_circuit_callback(ctx: Context<MyCircuitCallback>, output: /* ... */) -> Result<()> {
    // Handle result
    Ok(())
}
```

3. Rebuild and test:

```bash
anchor build
anchor test
```

---

## ğŸ” Security

### Trust Model

| Component | Trust Assumption |
|-----------|------------------|
| **Anchor Program** | Open source, auditable |
| **Arcium MXE** | Honest majority (2/3+ nodes) |
| **x25519 Encryption** | Standard cryptographic security |
| **Client** | User controls their keys |

### Security Properties

- âœ… **Balance privacy** â€” No one sees actual amounts
- âœ… **MEV protection** â€” Encrypted until execution
- âœ… **Non-custodial** â€” User holds encryption keys
- âœ… **Verifiable** â€” Threshold signatures prove correctness

### Limitations

- âš ï¸ **Devnet only** â€” Not audited for mainnet
- âš ï¸ **MXE trust** â€” Requires honest majority assumption
- âš ï¸ **Latency** â€” MPC adds ~2-5 seconds vs direct transaction

### Reporting Security Issues

If you discover a vulnerability:
- Email: **security@sip-protocol.org**
- Do NOT open public issues for security vulnerabilities

---

## ğŸ”— Related Projects

| Project | Description | Link |
|---------|-------------|------|
| **sip-protocol** | Core SDK (6,600+ tests) | [GitHub](https://github.com/sip-protocol/sip-protocol) |
| **sip-mobile** | Mobile wallet (uses Arcium adapter) | [GitHub](https://github.com/sip-protocol/sip-mobile) |
| **sip-app** | Web application | [GitHub](https://github.com/sip-protocol/sip-app) |
| **Arcium Docs** | MPC framework documentation | [arcium.com/docs](https://docs.arcium.com) |

---

## ğŸ“„ License

[MIT License](LICENSE) â€” see LICENSE file for details.

---

<div align="center">

**Solana Privacy Hackathon 2026 â€” Arcium Track**

*Privacy through MPC â€” no single node sees your data*

[Showcase](https://sip-protocol.org/showcase/solana-privacy-2026) Â· [Documentation](https://docs.sip-protocol.org) Â· [Report Bug](https://github.com/sip-protocol/sip-arcium-program/issues)

*Part of the [SIP Protocol](https://github.com/sip-protocol) ecosystem*

</div>
